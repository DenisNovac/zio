# Работа с ресурсами

Возможности управления ресурсами в ZIO работают в синхронных, асинхронных, конкуррентных и всех других типах, и предоставляют гарантии работы при сбоях, прерываниях и прочем.

## Финализация

`ensuring` гарантирует исполнение независимо от того, что произошло с эффектом:

```scala
val finalizer = 
  UIO.effectTotal(println("Finalizing!"))

val finalized: IO[String, Unit] = 
  IO.fail("Failed!").ensuring(finalizer)
```

Финализатор не может фейлить, он должен обработать все ошибки внутри себя.

## Bracket

Часто try/finally используется чтобы гарантированно освободить ресурс. ZIO имеет такой функционал в виде метода `bracket`, который позволяет:

- *занять* эффект, который занимает ресурс; 
- *освободить* эффект, который освобождает ресурc;
- *воспользоваться* эффектом, который пользуется ресурсом.

Эффект освобождения гарантированно произойдет даже в случае прерывания или ошибки:

```scala
val groupedFileData: IO[IOException, Unit] = 
  openFile("data.json").bracket(closeFile(_)) { file =>
    for {
      data    <- decodeData(file)
      grouped <- groupData(data)
    } yield grouped
  }
```


